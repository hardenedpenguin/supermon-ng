From ad67238c71d2c10b57e83aa414c5fb3bcc75f395 Mon Sep 17 00:00:00 2001
From: "Jory A. Pratt" <geekypenguin@gmail.com>
Date: Sat, 5 Jul 2025 15:38:26 -0500
Subject: [PATCH] Re-enable Service Worker and PWA functionality

- Uncommented PWA manifest and meta tags in header.inc
- Re-enabled modern-header.js for Service Worker registration
- Created offline.html for offline fallback page
- Service Worker provides caching, offline access, and background sync
- PWA features: install prompt, app-like experience, update notifications
---
 header.inc   | 15 ++++++------
 offline.html | 68 ++++++++++++++++++++++++++++++++++++++++++++++++++++
 2 files changed, 75 insertions(+), 8 deletions(-)
 create mode 100644 offline.html

diff --git a/header.inc b/header.inc
index b527484..b764915 100644
--- a/header.inc
+++ b/header.inc
@@ -135,16 +135,15 @@ $(document).ready(function() {
 <script src="js/utils.js"></script>
 <script src="js/auth.js"></script>
 <script src="js/app.js"></script>
-<!-- <script src="js/modern-header.js"></script> -->
+<script src="js/modern-header.js"></script>
 
 <!-- PWA Manifest -->
-<!-- Temporarily disabled for mobile testing -->
-<!-- <link rel="manifest" href="manifest.json"> -->
-<!-- <meta name="theme-color" content="#007bff"> -->
-<!-- <meta name="mobile-web-app-capable" content="yes"> -->
-<!-- <meta name="apple-mobile-web-app-status-bar-style" content="default"> -->
-<!-- <meta name="apple-mobile-web-app-title" content="Supermon-ng"> -->
-<!-- <link rel="apple-touch-icon" href="/favicon.ico"> -->
+<link rel="manifest" href="manifest.json">
+<meta name="theme-color" content="#007bff">
+<meta name="mobile-web-app-capable" content="yes">
+<meta name="apple-mobile-web-app-status-bar-style" content="default">
+<meta name="apple-mobile-web-app-title" content="Supermon-ng">
+<link rel="apple-touch-icon" href="/favicon.ico">
 
 <?php
 // Set header title variables for JavaScript
diff --git a/offline.html b/offline.html
new file mode 100644
index 0000000..6e512b0
--- /dev/null
+++ b/offline.html
@@ -0,0 +1,68 @@
+<!DOCTYPE html>
+<html lang="en">
+<head>
+    <meta charset="UTF-8">
+    <meta name="viewport" content="width=device-width, initial-scale=1.0">
+    <title>Supermon-ng - Offline</title>
+    <style>
+        body {
+            font-family: Arial, sans-serif;
+            text-align: center;
+            padding: 50px;
+            background-color: #f8f9fa;
+        }
+        .offline-container {
+            max-width: 600px;
+            margin: 0 auto;
+            background: white;
+            padding: 40px;
+            border-radius: 8px;
+            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
+        }
+        .offline-icon {
+            font-size: 64px;
+            color: #dc3545;
+            margin-bottom: 20px;
+        }
+        h1 {
+            color: #343a40;
+            margin-bottom: 20px;
+        }
+        p {
+            color: #6c757d;
+            line-height: 1.6;
+        }
+        .retry-btn {
+            background-color: #007bff;
+            color: white;
+            border: none;
+            padding: 12px 24px;
+            border-radius: 4px;
+            cursor: pointer;
+            font-size: 16px;
+            margin-top: 20px;
+        }
+        .retry-btn:hover {
+            background-color: #0056b3;
+        }
+    </style>
+</head>
+<body>
+    <div class="offline-container">
+        <div class="offline-icon">ðŸ“¡</div>
+        <h1>You're Offline</h1>
+        <p>It looks like you've lost your connection to the Supermon-ng server.</p>
+        <p>Please check your internet connection and try again.</p>
+        <button class="retry-btn" onclick="window.location.reload()">Retry Connection</button>
+    </div>
+    
+    <script>
+        // Check for connection every 5 seconds
+        setInterval(() => {
+            if (navigator.onLine) {
+                window.location.reload();
+            }
+        }, 5000);
+    </script>
+</body>
+</html> 
\ No newline at end of file
-- 
2.39.5

