{"version":3,"file":"RptStats-CRVlevi4.js","sources":["../../src/components/RptStats.vue"],"sourcesContent":["<template>\n  <div v-if=\"isVisible\" class=\"modal-overlay\" @click=\"closeModal\">\n    <div class=\"modal-content\" @click.stop>\n      <div class=\"modal-header\">\n        <h3>RPT Statistics</h3>\n        <button class=\"close-button\" @click=\"closeModal\">&times;</button>\n      </div>\n      \n      <div class=\"modal-body\">\n        <!-- Node Selection -->\n        <div class=\"input-section\">\n          <label for=\"nodeInput\">Node Number:</label>\n          <input \n            id=\"nodeInput\"\n            v-model=\"nodeNumber\" \n            type=\"text\" \n            placeholder=\"Enter node number\"\n            class=\"node-input\"\n          />\n          <div class=\"button-group\">\n            <button @click=\"getLocalStats\" class=\"btn btn-primary\" :disabled=\"!nodeNumber\">\n              Get Local Stats\n            </button>\n            <button @click=\"getExternalStats\" class=\"btn btn-secondary\" :disabled=\"!nodeNumber\">\n              Get External Stats\n            </button>\n          </div>\n        </div>\n\n        <!-- Loading State -->\n        <div v-if=\"loading\" class=\"loading\">\n          <div class=\"spinner\"></div>\n          <p>Retrieving RPT statistics...</p>\n        </div>\n\n        <!-- Error State -->\n        <div v-if=\"error\" class=\"error-message\">\n          <p>{{ error }}</p>\n        </div>\n\n        <!-- External Stats Redirect -->\n        <div v-if=\"externalUrl\" class=\"external-redirect\">\n          <p>Redirecting to external AllStar Link statistics...</p>\n          <a :href=\"externalUrl\" target=\"_blank\" class=\"btn btn-primary\">\n            Open External Stats\n          </a>\n          <button @click=\"closeExternalRedirect\" class=\"btn btn-secondary\">\n            Cancel\n          </button>\n        </div>\n\n        <!-- Local Stats Display -->\n        <div v-if=\"localStats\" class=\"stats-display\">\n          <div class=\"stats-header\">\n            <h4>RPT Statistics for Node {{ nodeNumber }}</h4>\n            <span class=\"timestamp\">{{ formatTimestamp(localStats.timestamp) }}</span>\n          </div>\n          <pre class=\"stats-content\">{{ localStats.stats }}</pre>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, watch } from 'vue'\nimport { api } from '@/utils/api'\n\nconst props = defineProps({\n  isVisible: {\n    type: Boolean,\n    default: false\n  },\n  nodeNumber: {\n    type: String,\n    default: ''\n  }\n})\n\nconst emit = defineEmits(['update:isVisible'])\n\n// Reactive state\nconst nodeNumber = ref(props.nodeNumber || '')\nconst loading = ref(false)\nconst error = ref('')\nconst externalUrl = ref('')\nconst localStats = ref(null)\n\n// Watch for prop changes\nwatch(() => props.isVisible, (newVal) => {\n  if (newVal && props.nodeNumber) {\n    nodeNumber.value = props.nodeNumber\n  }\n})\n\nwatch(() => props.nodeNumber, (newVal) => {\n  if (newVal) {\n    nodeNumber.value = newVal\n  }\n})\n\n// Methods\nconst closeModal = () => {\n  emit('update:isVisible', false)\n  resetState()\n}\n\nconst resetState = () => {\n  loading.value = false\n  error.value = ''\n  externalUrl.value = ''\n  localStats.value = null\n}\n\nconst getLocalStats = async () => {\n  if (!nodeNumber.value) {\n    error.value = 'Please enter a node number'\n    return\n  }\n\n  loading.value = true\n  error.value = ''\n  externalUrl.value = ''\n  localStats.value = null\n\n  try {\n    const response = await api.post('/nodes/rptstats', {\n      localnode: nodeNumber.value\n    })\n\n    if (response.data.success) {\n      if (response.data.type === 'local') {\n        localStats.value = response.data.data\n      } else if (response.data.type === 'external') {\n        externalUrl.value = response.data.url\n      }\n    } else {\n      error.value = response.data.message || 'Failed to retrieve RPT statistics'\n    }\n  } catch (err) {\n    console.error('RPT Stats error:', err)\n    error.value = err.response?.data?.message || 'Failed to retrieve RPT statistics'\n  } finally {\n    loading.value = false\n  }\n}\n\nconst getExternalStats = async () => {\n  if (!nodeNumber.value) {\n    error.value = 'Please enter a node number'\n    return\n  }\n\n  loading.value = true\n  error.value = ''\n  externalUrl.value = ''\n  localStats.value = null\n\n  try {\n    const response = await api.post('/nodes/rptstats', {\n      node: nodeNumber.value\n    })\n\n    if (response.data.success) {\n      if (response.data.type === 'external') {\n        externalUrl.value = response.data.url\n      }\n    } else {\n      error.value = response.data.message || 'Failed to retrieve external RPT statistics'\n    }\n  } catch (err) {\n    console.error('External RPT Stats error:', err)\n    error.value = err.response?.data?.message || 'Failed to retrieve external RPT statistics'\n  } finally {\n    loading.value = false\n  }\n}\n\nconst closeExternalRedirect = () => {\n  externalUrl.value = ''\n}\n\nconst formatTimestamp = (timestamp) => {\n  if (!timestamp) return ''\n  return new Date(timestamp).toLocaleString()\n}\n</script>\n\n<style scoped>\n.modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  z-index: 1000;\n}\n\n.modal-content {\n  background-color: var(--background-color);\n  border-radius: 8px;\n  width: 40%;\n  max-width: 500px;\n  max-height: 60vh;\n  overflow: hidden;\n  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);\n  border: 1px solid var(--border-color);\n}\n\n.modal-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 1rem 1.5rem;\n  border-bottom: 1px solid var(--border-color);\n  background-color: var(--container-bg);\n}\n\n.modal-header h3 {\n  margin: 0;\n  color: var(--text-color);\n}\n\n.close-button {\n  background: none;\n  border: none;\n  font-size: 1.5rem;\n  cursor: pointer;\n  color: var(--text-color);\n  padding: 0;\n  width: 30px;\n  height: 30px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n\n.close-button:hover {\n  color: var(--link-color);\n}\n\n.modal-body {\n  padding: 1.5rem;\n  max-height: calc(60vh - 120px);\n  overflow-y: auto;\n}\n\n.input-section {\n  margin-bottom: 1.5rem;\n}\n\n.input-section label {\n  display: block;\n  margin-bottom: 0.5rem;\n  color: var(--text-color);\n  font-weight: bold;\n}\n\n.node-input {\n  width: 100%;\n  padding: 0.75rem;\n  border: 1px solid var(--border-color);\n  border-radius: 4px;\n  background-color: var(--input-bg);\n  color: var(--text-color);\n  margin-bottom: 1rem;\n}\n\n.button-group {\n  display: flex;\n  gap: 1rem;\n  flex-wrap: wrap;\n}\n\n.btn {\n  padding: 0.75rem 1.5rem;\n  border: none;\n  border-radius: 4px;\n  cursor: pointer;\n  font-weight: bold;\n  transition: background-color 0.3s ease;\n}\n\n.btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.btn-primary {\n  background-color: var(--link-color);\n  color: white;\n}\n\n.btn-primary:hover:not(:disabled) {\n  background-color: var(--link-hover);\n}\n\n.btn-secondary {\n  background-color: var(--secondary-bg);\n  color: var(--text-color);\n  border: 1px solid var(--border-color);\n}\n\n.btn-secondary:hover:not(:disabled) {\n  background-color: var(--secondary-hover);\n}\n\n.loading {\n  text-align: center;\n  padding: 2rem;\n}\n\n.spinner {\n  border: 3px solid var(--border-color);\n  border-top: 3px solid var(--link-color);\n  border-radius: 50%;\n  width: 40px;\n  height: 40px;\n  animation: spin 1s linear infinite;\n  margin: 0 auto 1rem;\n}\n\n@keyframes spin {\n  0% { transform: rotate(0deg); }\n  100% { transform: rotate(360deg); }\n}\n\n.error-message {\n  background-color: var(--error-bg);\n  color: var(--error-color);\n  padding: 1rem;\n  border-radius: 4px;\n  margin: 1rem 0;\n}\n\n.external-redirect {\n  text-align: center;\n  padding: 2rem;\n  background-color: var(--info-bg);\n  border-radius: 4px;\n  margin: 1rem 0;\n}\n\n.external-redirect p {\n  margin-bottom: 1rem;\n  color: var(--text-color);\n}\n\n.stats-display {\n  margin-top: 1.5rem;\n}\n\n.stats-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 1rem;\n  padding-bottom: 0.5rem;\n  border-bottom: 1px solid var(--border-color);\n}\n\n.stats-header h4 {\n  margin: 0;\n  color: var(--text-color);\n}\n\n.timestamp {\n  font-size: 0.875rem;\n  color: var(--secondary-text);\n}\n\n.stats-content {\n  background-color: #000000;\n  color: #ffffff;\n  padding: 1rem;\n  border-radius: 4px;\n  font-family: 'Courier New', Consolas, monospace;\n  font-size: 12px;\n  line-height: 1.3;\n  white-space: pre-wrap;\n  word-wrap: break-word;\n  max-height: 400px;\n  overflow-y: auto;\n  border: 1px solid var(--border-color);\n}\n</style>\n"],"names":["props","__props","emit","__emit","nodeNumber","ref","loading","error","externalUrl","localStats","watch","newVal","closeModal","resetState","getLocalStats","response","api","err","_b","_a","getExternalStats","closeExternalRedirect","formatTimestamp","timestamp","_createElementBlock","_createElementVNode","_cache","_hoisted_1","_hoisted_2","$event","_hoisted_3","_hoisted_4","_hoisted_5","_openBlock","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_toDisplayString","_hoisted_12","_hoisted_13"],"mappings":"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"}