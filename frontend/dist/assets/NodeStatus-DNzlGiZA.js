import{f as u,l as x,k as c,g as o,m as L,t as f,h as O,i as v,v as S,C as U,K as I,L as P,r as l,w as R}from"./vendor-BDu8AGUg.js";import{_ as B,a as C}from"./index-ixAHyd21.js";const F={name:"NodeStatus",props:{isVisible:{type:Boolean,default:!1}},emits:["close"],setup(E,{emit:s}){const g=l(!1),t=l(!1),_=l(!1),i=l(""),n=l({nodes:[],wx_code:"",wx_location:"",temp_unit:"F",skywarnplus_enabled:!1,api_url:""}),r=l(""),p=l(null),w=()=>{s("close")},m=async()=>{var a,b,k,N,V,M,A;g.value=!0;try{const y=await C.get("/node-status/config");if(y.data.success&&y.data.config){const d=y.data.config;n.value={nodes:((b=(a=d.general)==null?void 0:a.NODE)==null?void 0:b.split(" "))||[],wx_code:((k=d.general)==null?void 0:k.WX_CODE)||"",wx_location:((N=d.general)==null?void 0:N.WX_LOCATION)||"",temp_unit:((V=d.general)==null?void 0:V.TEMP_UNIT)||"F",skywarnplus_enabled:((M=d.skywarnplus)==null?void 0:M.MASTER_ENABLE)==="yes",api_url:((A=d.skywarnplus)==null?void 0:A.API_URL)||""},r.value=n.value.nodes.join(" ")}}catch(y){console.error("Error loading node status config:",y)}finally{g.value=!1}},e=async()=>{try{const a=await C.get("/node-status/service-status");a.data.success&&(p.value=a.data)}catch(a){console.error("Error loading service status:",a)}},T=async()=>{t.value=!0;try{const a={...n.value,nodes:r.value.split(" ").filter(k=>k.trim())},b=await C.put("/node-status/config",a);b.data.success?alert("Configuration saved successfully!"):alert("Error saving configuration: "+b.data.message)}catch(a){console.error("Error saving config:",a),alert("Error saving configuration")}finally{t.value=!1}},D=async()=>{_.value=!0,i.value="";try{const a=await C.post("/node-status/trigger-update");a.data.success?(i.value=a.data.output||"Update completed successfully",await e()):i.value="Error: "+a.data.message}catch(a){console.error("Error triggering update:",a),i.value="Error triggering update"}finally{_.value=!1}};return R(()=>E.isVisible,a=>{a&&(m(),e())}),{loading:g,saving:t,updating:_,updateOutput:i,config:n,nodeNumbers:r,serviceStatus:p,closeModal:w,loadConfig:m,saveConfig:T,triggerUpdate:D}}},W={class:"modal-content node-status-modal"},X={class:"modal-header"},j={class:"modal-body"},q={key:0,class:"loading"},z={key:1,class:"config-form"},G={class:"status-section"},K={class:"status-info"},H={class:"status-item"},J={class:"status-item"},Q={key:0,class:"status-item"},Y={class:"status-value"},Z={class:"action-buttons"},h=["disabled"],$={class:"form-group"},ss={class:"form-group"},os={class:"form-group"},ts={class:"form-group"},es={class:"form-group"},as={class:"checkbox-label"},ns={key:0,class:"skywarnplus-config"},ls={class:"form-group"},is={class:"form-actions"},rs=["disabled"],ds={key:2,class:"update-output"};function us(E,s,g,t,_,i){var n,r,p,w,m;return g.isVisible?(c(),u("div",{key:0,class:"modal-overlay",onClick:s[10]||(s[10]=O((...e)=>t.closeModal&&t.closeModal(...e),["self"]))},[o("div",W,[o("div",X,[s[11]||(s[11]=o("h3",null,"Node Status Configuration",-1)),o("button",{onClick:s[0]||(s[0]=(...e)=>t.closeModal&&t.closeModal(...e)),class:"close-button"},"×")]),o("div",j,[t.loading?(c(),u("div",q,[...s[12]||(s[12]=[o("p",null,"Loading configuration...",-1)])])):(c(),u("div",z,[o("div",G,[s[16]||(s[16]=o("h4",null,"Service Status",-1)),o("div",K,[o("div",H,[s[13]||(s[13]=o("span",{class:"status-label"},"Service:",-1)),o("span",{class:L(["status-value",(n=t.serviceStatus)!=null&&n.service_active?"active":"inactive"])},f((r=t.serviceStatus)!=null&&r.service_active?"Running":"Stopped"),3)]),o("div",J,[s[14]||(s[14]=o("span",{class:"status-label"},"Auto-start:",-1)),o("span",{class:L(["status-value",(p=t.serviceStatus)!=null&&p.service_enabled?"enabled":"disabled"])},f((w=t.serviceStatus)!=null&&w.service_enabled?"Enabled":"Disabled"),3)]),(m=t.serviceStatus)!=null&&m.last_update?(c(),u("div",Q,[s[15]||(s[15]=o("span",{class:"status-label"},"Last Update:",-1)),o("span",Y,f(t.serviceStatus.last_update),1)])):x("",!0)]),o("div",Z,[o("button",{onClick:s[1]||(s[1]=(...e)=>t.triggerUpdate&&t.triggerUpdate(...e)),disabled:t.updating,class:"btn btn-primary"},f(t.updating?"Updating...":"Update Now"),9,h)])]),o("form",{onSubmit:s[9]||(s[9]=O((...e)=>t.saveConfig&&t.saveConfig(...e),["prevent"])),class:"config-section"},[s[26]||(s[26]=o("h4",null,"Configuration",-1)),o("div",$,[s[17]||(s[17]=o("label",{for:"nodes"},"Node Numbers:",-1)),v(o("input",{type:"text",id:"nodes","onUpdate:modelValue":s[2]||(s[2]=e=>t.nodeNumbers=e),placeholder:"546051 546055 546056",class:"form-control",required:""},null,512),[[S,t.nodeNumbers]]),s[18]||(s[18]=o("small",{class:"form-text"},[U("Space-separated node numbers. Each must have a "),o("code",null,"[node]"),U(" section in /etc/asterisk/rpt.conf (local nodes on this server). Use the same nodes you monitor in allmon.ini.")],-1))]),o("div",ss,[s[19]||(s[19]=o("label",{for:"wx_code"},"Weather Code:",-1)),v(o("input",{type:"text",id:"wx_code","onUpdate:modelValue":s[3]||(s[3]=e=>t.config.wx_code=e),placeholder:"77511",class:"form-control"},null,512),[[S,t.config.wx_code]])]),o("div",os,[s[20]||(s[20]=o("label",{for:"wx_location"},"Weather Location:",-1)),v(o("input",{type:"text",id:"wx_location","onUpdate:modelValue":s[4]||(s[4]=e=>t.config.wx_location=e),placeholder:"Alvin, Texas",class:"form-control"},null,512),[[S,t.config.wx_location]])]),o("div",ts,[s[22]||(s[22]=o("label",{for:"temp_unit"},"Temperature Unit:",-1)),v(o("select",{id:"temp_unit","onUpdate:modelValue":s[5]||(s[5]=e=>t.config.temp_unit=e),class:"form-control"},[...s[21]||(s[21]=[o("option",{value:"F"},"Fahrenheit (°F)",-1),o("option",{value:"C"},"Celsius (°C)",-1)])],512),[[I,t.config.temp_unit]])]),o("div",es,[o("label",as,[v(o("input",{type:"checkbox","onUpdate:modelValue":s[6]||(s[6]=e=>t.config.skywarnplus_enabled=e)},null,512),[[P,t.config.skywarnplus_enabled]]),s[23]||(s[23]=U(" Enable SkywarnPlus Weather Alerts ",-1))])]),t.config.skywarnplus_enabled?(c(),u("div",ns,[o("div",ls,[s[24]||(s[24]=o("label",{for:"api_url"},"API URL:",-1)),v(o("input",{type:"url",id:"api_url","onUpdate:modelValue":s[7]||(s[7]=e=>t.config.api_url=e),placeholder:"http://10.0.0.5:8100",class:"form-control"},null,512),[[S,t.config.api_url]]),s[25]||(s[25]=o("small",{class:"form-text"},"SkywarnPlus-NG API endpoint URL",-1))])])):x("",!0),o("div",is,[o("button",{type:"submit",disabled:t.saving,class:"btn btn-success"},f(t.saving?"Saving...":"Save Configuration"),9,rs),o("button",{type:"button",onClick:s[8]||(s[8]=(...e)=>t.loadConfig&&t.loadConfig(...e)),class:"btn btn-secondary"}," Reset ")])],32)])),t.updateOutput?(c(),u("div",ds,[s[27]||(s[27]=o("h4",null,"Update Output:",-1)),o("pre",null,f(t.updateOutput),1)])):x("",!0)])])])):x("",!0)}const vs=B(F,[["render",us],["__scopeId","data-v-b355b5b5"]]);export{vs as default};
//# sourceMappingURL=NodeStatus-DNzlGiZA.js.map
