import{e as M,r as i,c as G,w as I,o as q,G as z,k as l,q as A,P as D,T as Q,Q as W,f as n,l as g,g as e,t as d,C as V,F as Y,p as j,m as H}from"./vendor-BDu8AGUg.js";import{a as C,_ as J}from"./index-Cd0Rm2MK.js";import K from"./AddFavorite-Dg5zPG1E.js";const O={key:0,class:"favorites-modal"},R={class:"favorites-content"},X={class:"favorites-header"},Z={class:"header-actions"},ee={class:"favorites-body"},se={key:0,class:"loading"},ae={key:1,class:"error-message"},te={key:2,class:"success-message"},oe={key:3,class:"empty-state"},le={key:4,class:"favorites-section"},ne={class:"favorites-info"},de={class:"favorites-table"},ie={class:"command-preview"},ue={class:"node-info"},ce={key:0,class:"source-node"},re={class:"section-badge node"},ve={key:1,class:"target-node"},me={class:"section-badge target"},pe={key:2,class:"no-target"},fe=["onClick","disabled"],ge={class:"favorites-footer"},be={class:"button-group"},_e=M({__name:"Favorites",props:{open:{type:Boolean},localNode:{}},emits:["update:open","command-executed"],setup(N,{emit:E}){const m=N,x=E,v=i(!1),p=i(!1),u=i(""),o=i(null),f=i([]),_=i(""),y=i(""),h=i(!1),S=i(""),c=i([]),U=G(()=>o.value&&o.value.success?"Command Executed Successfully":u.value?"Error Loading Favorites":f.value.length===0&&!v.value?"No Favorites Found":"Favorites Panel"),B=async()=>{try{const t=await C.get("/nodes");t.data.success?c.value=t.data.data||[]:c.value=[]}catch(t){console.error("Failed to load available nodes:",t),c.value=[]}},F=async()=>{var t,s;v.value=!0,u.value="",o.value=null;try{B();const a=await C.get("/config/favorites");a.data.success?(f.value=a.data.data,_.value=a.data.user||"Unknown User",y.value=a.data.fileName||"favorites.ini"):u.value=a.data.message||"Failed to load favorites"}catch(a){const r=a;u.value=((s=(t=r.response)==null?void 0:t.data)==null?void 0:s.message)||"Failed to load favorites"}finally{v.value=!1}},L=async t=>{if(t.section==="general"){let s=null;if(c.value.length===1)s=String(c.value[0].id);else if(m.localNode&&c.value.length>0){const a=c.value.find(r=>String(r.id)===m.localNode);a&&(s=String(a.id))}if(!s&&(s=prompt(`Enter node number for command "${t.label}":`),!s))return;await w(t,s)}else t.node?await w(t,t.node):u.value="No node specified for this favorite"},w=async(t,s)=>{var a,r;p.value=!0,u.value="";try{const b=await C.post("/config/favorites/execute",{node:s,command:t.command});o.value={success:b.data.success,message:b.data.message,executed_label:t.label},x("command-executed",o.value)}catch(b){const P=b;o.value={success:!1,message:((r=(a=P.response)==null?void 0:a.data)==null?void 0:r.message)||"Failed to execute command",executed_label:t.label}}finally{p.value=!1}},T=()=>{window.location.reload()},$=t=>{t.success&&(F(),o.value={success:!0,message:t.message,executed_label:t.label})},k=()=>{x("update:open",!1),v.value=!1,p.value=!1,u.value="",o.value=null,f.value=[],_.value="",y.value="",c.value=[]};return I(()=>m.open,t=>{t&&F()}),q(()=>{m.open&&F()}),(t,s)=>(l(),z(W,{to:"body"},[A(Q,{name:"modal"},{default:D(()=>[N.open?(l(),n("div",O,[e("div",{class:"favorites-overlay",onClick:k}),e("div",R,[e("div",X,[e("h2",null,d(U.value),1),e("div",Z,[e("button",{onClick:s[0]||(s[0]=a=>h.value=!0),class:"add-favorite-btn"}," Add Favorite "),e("button",{class:"close-button",onClick:k},"Ã—")])]),e("div",ee,[v.value?(l(),n("div",se,[...s[2]||(s[2]=[e("p",null,"Loading favorites...",-1)])])):u.value?(l(),n("div",ae,[e("p",null,d(u.value),1)])):o.value&&o.value.success?(l(),n("div",te,[e("p",null,d(o.value.message),1)])):!v.value&&f.value.length===0?(l(),n("div",oe,[...s[3]||(s[3]=[e("h3",null,"No Favorites Found",-1),e("p",null,"You don't have any favorites configured yet.",-1),e("p",null,'Use the "Add Favorite" button to add nodes to your favorites list.',-1)])])):(l(),n("div",le,[e("div",ne,[s[6]||(s[6]=e("h3",null,"Favorites File",-1)),e("p",null,[s[4]||(s[4]=e("strong",null,"User:",-1)),V(" "+d(_.value),1)]),e("p",null,[s[5]||(s[5]=e("strong",null,"File:",-1)),V(" "+d(y.value),1)])]),e("table",de,[s[10]||(s[10]=e("thead",null,[e("tr",null,[e("th",null,"Section"),e("th",null,"Label"),e("th",null,"Command"),e("th",null,"Node"),e("th",null,"Action")])],-1)),e("tbody",null,[(l(!0),n(Y,null,j(f.value,a=>(l(),n("tr",{key:`${a.section}-${a.index}`},[e("td",null,[e("span",{class:H(["section-badge",a.section==="general"?"general":"node"])},d(a.section),3)]),e("td",null,d(a.label),1),e("td",null,[e("div",ie,d(a.command),1)]),e("td",null,[e("div",ue,[a.node?(l(),n("div",ce,[s[7]||(s[7]=e("span",{class:"node-label"},"From:",-1)),e("span",re,d(a.node),1)])):g("",!0),a.target_node?(l(),n("div",ve,[s[8]||(s[8]=e("span",{class:"node-label"},"To:",-1)),e("span",me,d(a.target_node),1)])):g("",!0),!a.node&&!a.target_node?(l(),n("div",pe,[...s[9]||(s[9]=[e("span",{class:"node-label"},"General",-1)])])):g("",!0)])]),e("td",null,[e("button",{type:"button",class:"connect-btn",onClick:r=>L(a),disabled:p.value},d(p.value?"Connecting...":"Connect"),9,fe)])]))),128))])])]))]),e("div",ge,[e("div",be,[o.value&&o.value.success?(l(),n("input",{key:0,type:"button",value:"Refresh Parent Window",onClick:T,class:"refresh-btn"})):g("",!0),e("input",{type:"button",value:"Close",onClick:k,class:"close-btn"})])])])])):g("",!0)]),_:1}),A(K,{isVisible:h.value,"onUpdate:isVisible":s[1]||(s[1]=a=>h.value=a),"node-number":S.value,"local-node":m.localNode||"",onFavoriteAdded:$},null,8,["isVisible","node-number","local-node"])]))}}),ke=J(_e,[["__scopeId","data-v-70fdcc0a"]]);export{ke as default};
//# sourceMappingURL=Favorites-CHarSUFz.js.map
