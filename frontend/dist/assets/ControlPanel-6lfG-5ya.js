import{r as u,c as P,w as C,f as s,l as _,k as a,g as e,t as v,C as S,i as E,K as F,F as B,p as M,m as D,h as L}from"./vendor-BDu8AGUg.js";import{_ as T,a as h}from"./index-Cd0Rm2MK.js";const q={class:"modal-body"},z={key:0,class:"loading"},I={key:1,class:"error-message"},K={key:2,class:"no-commands"},R={key:3,class:"control-panel"},U={class:"node-info"},W={class:"command-section"},$=["disabled"],j=["value"],A={class:"execute-section"},G=["disabled"],H={key:0},J={key:1},O={key:0,class:"result-section"},Q={__name:"ControlPanel",props:{isVisible:{type:Boolean,default:!1},localNode:{type:String,required:!0}},emits:["update:isVisible"],setup(f,{emit:k}){const t=f,x=k,m=u(!1),d=u(""),i=u({labels:[],cmds:[]}),c=u(""),r=u(!1),n=u(null),N=P(()=>i.value.labels&&i.value.labels.length>0),p=()=>{x("update:isVisible",!1),w()},w=()=>{m.value=!1,d.value="",i.value={labels:[],cmds:[]},c.value="",r.value=!1,n.value=null},y=async()=>{if(!t.localNode){d.value="Please select a node first";return}m.value=!0,d.value="";try{const o=await h.get(`/config/controlpanel?node=${t.localNode}`);o.data.success?i.value=o.data.data:d.value=o.data.message||"Failed to load control panel commands"}catch(o){console.error("Error loading control panel commands:",o),d.value="Failed to load control panel commands. Please try again."}finally{m.value=!1}},V=async()=>{if(!(!c.value||!t.localNode)){r.value=!0,n.value=null;try{const o=await h.post("/config/controlpanel/execute",{node:t.localNode,command:c.value});o.data.success?n.value={error:!1,message:o.data.data.result||"Command executed successfully"}:n.value={error:!0,message:o.data.message||"Command execution failed"}}catch(o){console.error("Error executing command:",o),n.value={error:!0,message:"Failed to execute command. Please try again."}}finally{r.value=!1}}};return C(()=>t.isVisible,o=>{o&&t.localNode&&y()}),C(()=>t.localNode,o=>{t.isVisible&&o&&y()}),(o,l)=>f.isVisible?(a(),s("div",{key:0,class:"modal-overlay",onClick:p},[e("div",{class:"modal-content",onClick:l[1]||(l[1]=L(()=>{},["stop"]))},[e("div",{class:"modal-header"},[l[2]||(l[2]=e("h2",null,"Control Panel",-1)),e("button",{class:"close-button",onClick:p},"Ã—")]),e("div",q,[m.value?(a(),s("div",z,[...l[3]||(l[3]=[e("div",{class:"spinner"},null,-1),e("p",null,"Loading control panel commands...",-1)])])):d.value?(a(),s("div",I,[e("p",null,v(d.value),1)])):N.value?(a(),s("div",R,[e("div",U,[e("p",null,[l[5]||(l[5]=e("strong",null,"Sending Command to node:",-1)),S(" "+v(f.localNode),1)])]),e("div",W,[l[7]||(l[7]=e("label",{for:"commandSelect"},"Control command (select one):",-1)),E(e("select",{id:"commandSelect","onUpdate:modelValue":l[0]||(l[0]=g=>c.value=g),class:"command-select",disabled:r.value},[l[6]||(l[6]=e("option",{value:""},"-- Select a command --",-1)),(a(!0),s(B,null,M(i.value.labels,(g,b)=>(a(),s("option",{key:b,value:i.value.cmds[b]},v(g),9,j))),128))],8,$),[[F,c.value]])]),e("div",A,[e("button",{onClick:V,disabled:!c.value||r.value,class:"execute-button"},[r.value?(a(),s("span",H,"Executing...")):(a(),s("span",J,"Execute"))],8,G)]),n.value?(a(),s("div",O,[l[8]||(l[8]=e("h4",null,"Command Result:",-1)),e("div",{class:D(["result-content",{error:n.value.error}])},[e("pre",null,v(n.value.message),1)],2)])):_("",!0)])):(a(),s("div",K,[...l[4]||(l[4]=[e("h3",null,"No Control Panel Commands Configured",-1),e("p",null,"To use the Control Panel, you need to configure commands in:",-1),e("code",null,"user_files/controlpanel.ini",-1),e("p",null,"Edit the file and uncomment the commands you want to use by removing the semicolon (;) from the beginning of the lines.",-1)])]))]),e("div",{class:"modal-footer"},[e("button",{onClick:p,class:"close-window-button"},"Close Window")])])])):_("",!0)}},Z=T(Q,[["__scopeId","data-v-a15e609a"]]);export{Z as default};
//# sourceMappingURL=ControlPanel-6lfG-5ya.js.map
