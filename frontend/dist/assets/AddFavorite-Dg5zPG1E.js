import{r as f,w as C,f as i,l as V,k as u,g as l,t as r,i as x,v as L,B,C as k,L as M,K as T,F as E,p as D,h as K}from"./vendor-BDu8AGUg.js";import{_,a as F}from"./index-Cd0Rm2MK.js";const q={class:"modal-body"},P={key:0,class:"loading"},G={key:1,class:"error-message"},j={key:2,class:"no-node-selected"},z={class:"node-input-section"},H={class:"form-group"},J={class:"button-group"},O=["disabled"],Q={key:3,class:"add-favorite-form"},R={class:"node-info"},W={class:"form-group"},X={class:"form-group"},Y={class:"checkbox-label"},Z={key:0,class:"form-group"},ee=["value","disabled"],le={key:0,class:"help-text",style:{color:"#ff6b6b"}},oe={class:"button-group"},ae=["disabled"],se={key:4,class:"no-node-info"},te={__name:"AddFavorite",props:{isVisible:{type:Boolean,default:!1},nodeNumber:{type:String,default:""},localNode:{type:String,default:""}},emits:["update:isVisible","favorite-added"],setup(h,{emit:$}){const t=h,I=$,g=f(!1),N=f(!1),p=f(""),n=f(null),b=f(""),v=f(!0),c=f(""),d=f(""),s=f([]);C(()=>t.nodeNumber,async o=>{o&&t.isVisible&&await w(o)}),C(()=>v.value,async o=>{if(!o&&s.value.length===1&&!d.value)d.value=s.value[0].id;else if(!o&&t.localNode&&s.value.length>1&&!d.value){const e=s.value.find(a=>String(a.id)===t.localNode);e&&(d.value=e.id)}}),C(()=>t.isVisible,async o=>{o?(await S(),t.nodeNumber&&await w(t.nodeNumber)):o||U()});const w=async o=>{if(o){g.value=!0,p.value="";try{const e=await F.get(`/config/node-info?node=${o}`);e.data.success?(n.value=e.data.nodeInfo,b.value=`${n.value.callsign} ${n.value.description} ${o}`):(n.value={node:o,callsign:`Node ${o}`,description:"Node",location:"Unknown"},b.value=`Node ${o}`)}catch{n.value={node:o,callsign:`Node ${o}`,description:"Node",location:"Unknown"},b.value=`Node ${o}`}finally{g.value=!1}}},S=async()=>{try{const o=await F.get("/nodes");if(o.data.success){if(s.value=o.data.data||[],s.value.length===1&&!v.value&&!d.value)d.value=s.value[0].id;else if(t.localNode&&s.value.length>1&&!v.value&&!d.value){const e=s.value.find(a=>String(a.id)===t.localNode);e&&(d.value=e.id)}}else s.value=[]}catch(o){console.error("Failed to load available nodes:",o),s.value=[]}},A=async()=>{var e,a;const o=t.nodeNumber||c.value;if(o){N.value=!0,p.value="";try{const m=await F.post("/config/favorites/add",{node:o,custom_label:b.value,add_to_general:v.value?"1":"0",source_node:v.value?null:d.value});m.data.success?(I("favorite-added",{success:!0,message:m.data.message,node:m.data.node,label:m.data.label}),y()):p.value=m.data.message||"Failed to add favorite"}catch(m){p.value=((a=(e=m.response)==null?void 0:e.data)==null?void 0:a.message)||"Failed to add favorite"}finally{N.value=!1}}},y=()=>{I("update:isVisible",!1)},U=()=>{g.value=!1,N.value=!1,p.value="",n.value=null,b.value="",v.value=!0,c.value="",d.value="",s.value=[]};return(o,e)=>h.isVisible?(u(),i("div",{key:0,class:"modal-overlay",onClick:y},[l("div",{class:"modal-content",onClick:e[6]||(e[6]=K(()=>{},["stop"]))},[l("div",{class:"modal-header"},[e[7]||(e[7]=l("h2",null,"Add Favorite",-1)),l("button",{class:"close-button",onClick:y},"Ã—")]),l("div",q,[g.value?(u(),i("div",P,[...e[8]||(e[8]=[l("p",null,"Loading node information...",-1)])])):p.value?(u(),i("div",G,r(p.value),1)):!t.nodeNumber&&!n.value?(u(),i("div",j,[l("div",z,[e[10]||(e[10]=l("h3",null,"Enter Node Number",-1)),e[11]||(e[11]=l("p",null,"Please enter a node number to add to your favorites:",-1)),l("div",H,[e[9]||(e[9]=l("label",{for:"node-input"},"Node Number:",-1)),x(l("input",{id:"node-input","onUpdate:modelValue":e[0]||(e[0]=a=>c.value=a),type:"text",placeholder:"Enter node number (e.g., 2000)",class:"form-input",onKeyup:e[1]||(e[1]=B(a=>w(c.value),["enter"]))},null,544),[[L,c.value]])]),l("div",J,[l("button",{onClick:e[2]||(e[2]=a=>w(c.value)),disabled:!c.value||g.value,class:"add-button"},r(g.value?"Loading...":"Load Node Info"),9,O),l("button",{onClick:y,class:"cancel-button"}," Cancel ")])])])):n.value?(u(),i("div",Q,[l("div",R,[e[16]||(e[16]=l("h3",null,"Node Information",-1)),l("p",null,[e[12]||(e[12]=l("strong",null,"Node:",-1)),k(" "+r(n.value.node),1)]),l("p",null,[e[13]||(e[13]=l("strong",null,"Callsign:",-1)),k(" "+r(n.value.callsign),1)]),l("p",null,[e[14]||(e[14]=l("strong",null,"Description:",-1)),k(" "+r(n.value.description),1)]),l("p",null,[e[15]||(e[15]=l("strong",null,"Location:",-1)),k(" "+r(n.value.location),1)])]),l("div",W,[e[17]||(e[17]=l("label",{for:"custom-label"},"Custom Label (optional):",-1)),x(l("input",{id:"custom-label","onUpdate:modelValue":e[3]||(e[3]=a=>b.value=a),type:"text",placeholder:"Enter custom label or leave blank for default",class:"form-input"},null,512),[[L,b.value]])]),l("div",X,[l("label",Y,[x(l("input",{"onUpdate:modelValue":e[4]||(e[4]=a=>v.value=a),type:"checkbox",class:"checkbox-input"},null,512),[[M,v.value]]),e[18]||(e[18]=k(" Add to General Favorites (works with any node) ",-1))]),e[19]||(e[19]=l("p",{class:"help-text"}," If checked, this favorite will be added to the general section and will prompt for a node number when executed. If unchecked, it will be added to a node-specific section. ",-1))]),v.value?V("",!0):(u(),i("div",Z,[e[21]||(e[21]=l("label",{for:"source-node"},"Source Node (required for node-specific favorites):",-1)),x(l("select",{id:"source-node","onUpdate:modelValue":e[5]||(e[5]=a=>d.value=a),class:"form-select",required:""},[e[20]||(e[20]=l("option",{value:""},"Select a source node...",-1)),(u(!0),i(E,null,D(s.value,a=>(u(),i("option",{key:a.id,value:a.id,disabled:a.id===(t.nodeNumber||c.value)},r(a.id)+" - "+r(a.system||"Node")+r(a.id===(t.nodeNumber||c.value)?" (same as target)":""),9,ee))),128))],512),[[T,d.value]]),e[22]||(e[22]=l("p",{class:"help-text"}," Select which local node this favorite is for. The connect command will use this node as the source. ",-1)),s.value.length===0?(u(),i("p",le," No available nodes found. Please check your configuration. ")):V("",!0)])),l("div",oe,[l("button",{onClick:A,disabled:N.value,class:"add-button"},r(N.value?"Adding...":"Add to Favorites"),9,ae),l("button",{onClick:y,class:"cancel-button"}," Cancel ")])])):(u(),i("div",se,[...e[23]||(e[23]=[l("p",null,"No node information available.",-1)])]))])])])):V("",!0)}},ie=_(te,[["__scopeId","data-v-af3bba64"]]);export{ie as default};
//# sourceMappingURL=AddFavorite-Dg5zPG1E.js.map
