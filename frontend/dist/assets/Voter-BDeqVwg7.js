import{r,E as S,w as B,f as v,l as b,k as c,g as a,j as M,i as $,v as N,B as L,F as z,p as H,t as k,h as U}from"./vendor-BDu8AGUg.js";import{_ as j,a as A}from"./index-Cd0Rm2MK.js";import{s as E}from"./Dashboard-qFOmSBh1.js";import"./dompurify-A66Cw1IH.js";const D={class:"voter-modal-content"},F={class:"voter-input-section"},K=["disabled"],R={key:0,class:"voter-containers"},G=["id"],O={class:"voter-spinner"},X=["id"],q={__name:"Voter",props:{show:{type:Boolean,default:!1}},emits:["close"],setup(m,{emit:T}){const w=m,I=T,n=r(""),o=r([]),p=r({}),i=r({}),f=["*","|","/","-","\\"];let d=null;const l=r(new Map),g=()=>{u(),I("close")},h=()=>{if(!n.value.trim())return;const e=n.value.split(",").map(t=>t.trim()).filter(t=>t);e.length!==0&&(o.value=e,V(),C())},u=()=>{Object.values(p.value).forEach(e=>{e&&e.close()}),p.value={},d&&(clearInterval(d),d=null),l.value.forEach((e,t)=>{clearTimeout(e)}),l.value.clear(),o.value=[],i.value={}},V=()=>{let e=0;d=setInterval(()=>{o.value.forEach(t=>{i.value[t]=f[e]}),e=(e+1)%f.length},200)},x=e=>i.value[e]||"*",C=()=>{o.value.forEach(e=>{e&&e.trim()!==""&&_(e)})},_=async e=>{if(o.value.includes(e))try{const t=await A.get(`/nodes/voter/status?node=${encodeURIComponent(e)}`);if(t.data.html){const s=document.getElementById(`link_list_${e}`);s&&(s.innerHTML=E(t.data.html))}if(t.data.spinner&&(i.value[e]=t.data.spinner),o.value.includes(e)){const s=setTimeout(()=>_(e),1e3);l.value.set(e,s)}}catch(t){console.error(`Error polling voter status for node ${e}:`,t);const s=document.getElementById(`link_list_${e}`);s&&(s.innerHTML=E(`<div class='error-message'>Error receiving updates for node ${e}. The connection was lost.</div>`)),i.value[e]="X";const y=l.value.get(e);y&&(clearTimeout(y),l.value.delete(e))}};return S(()=>{u()}),B(()=>w.show,e=>{e||u()}),(e,t)=>m.show?(c(),v("div",{key:0,class:"voter-modal-overlay",onClick:g},[a("div",{class:"voter-modal",onClick:t[1]||(t[1]=U(()=>{},["stop"]))},[a("div",{class:"voter-modal-header"},[t[2]||(t[2]=a("h2",null,"Voter Status",-1)),a("button",{class:"close-button",onClick:g},"Ã—")]),a("div",D,[a("div",F,[t[3]||(t[3]=a("label",{for:"voter-nodes"},"Node(s):",-1)),$(a("input",{id:"voter-nodes","onUpdate:modelValue":t[0]||(t[0]=s=>n.value=s),type:"text",placeholder:"Enter node number(s) e.g., 1234 or 1234,5678",onKeyup:L(h,["enter"])},null,544),[[N,n.value]]),a("button",{onClick:h,disabled:!n.value.trim()},"Start Voter",8,K)]),o.value.length>0?(c(),v("div",R,[(c(!0),v(z,null,H(o.value,s=>(c(),v("div",{key:s,class:"voter-container"},[a("div",{id:`link_list_${s}`,class:"voter-content"}," Connecting to Node "+k(s)+"... ",9,G),a("div",O,[a("span",{id:`spinner_${s}`,class:"spinner-text"},k(x(s)),9,X)])]))),128))])):b("",!0),t[4]||(t[4]=M('<div class="voter-info-container" data-v-09a41021><div class="voter-description" data-v-09a41021> The numbers indicate the relative signal strength. The value ranges from 0 to 255, a range of approximately 30db. A value of zero means that no signal is being received. The color of the bars indicate the type of RTCM client. </div><div class="voter-legend" data-v-09a41021><div class="legend-item legend-voting" data-v-09a41021>A blue bar indicates a voting station.</div><div class="legend-item legend-voted" data-v-09a41021>Green indicates the station is voted.</div><div class="legend-item legend-mix" data-v-09a41021>Cyan is a non-voting mix station.</div></div></div>',1))])])])):b("",!0)}},Y=j(q,[["__scopeId","data-v-09a41021"]]);export{Y as default};
//# sourceMappingURL=Voter-BDeqVwg7.js.map
